# Bitácora de Desarrollo - 2026-01-23

## Objetivo del Día

Implementar cimientos completos del sistema de personajes: BD, Modelos, Request, Controller y Rutas.
Debe quedar funcional la creación de personaje (1 por usuario) con validación de stats exactos y roles, e inicialización de equipamiento (slots vacíos) y montura.

## Checklist

- [ ] **Auditoría inicial**: Verificar estado actual de migraciones y modelos.
- [ ] **Migraciones**:
    - [ ] `races`: Añadir `min_role`, `stat_points_total`.
    - [ ] `game_classes` (Nueva): Crear tabla para Clases (`name`, `min_role`, etc.).
    - [ ] `characters`: Ajustar `user_id` (unique), añadir `class_id`, `stats_json`.
    - [ ] `inventory_and_equipment`: Ajustar `character_equipment` (item_id nullable, string slot), añadir `character_mount_equipment`.
- [ ] **Modelos**:
    - [ ] `Race`: Actualizar fillable y relaciones.
    - [ ] `GameClass`: Crear modelo y relaciones.
    - [ ] `Character`: Relaciones (User, Race, GameClass, Equipment, Mount), Casts (`stats_json`).
    - [ ] `Item`: Verificar relaciones.
    - [ ] `CharacterItem`: Crear modelo (Inventario).
    - [ ] `CharacterEquipment`: Actualizar (Slot como string).
    - [ ] `CharacterMountEquipment`: Crear modelo.
- [ ] **Lógica (Controller & Request)**:
    - [ ] `StoreCharacterRequest`: Validar `stats_json` (suma exacta), roles (`min_role`), unicidad de personaje.
    - [ ] `CharacterController`:
        - [ ] `create()`: Vista formulario.
        - [ ] `store()`: Crear personaje, inicializar slots vacíos en `character_equipment` y `character_mount_equipment`.
- [ ] **Rutas**: Registrar `/character/create` y `/character` (POST) en `web.php`.

## Decisiones Técnicas (Cerradas)

- **Unicidad**: 1 Personaje por User (`user_id` unique).
- **Borrado**: Irreversible (Sin SoftDeletes).
- **Slots Equipamiento**: `weapon`, `helmet`, `armor`, `ring`, `amulet`, `mount` (en `character_equipment`).
- **Slot Montura**: `mount_armor` (en `character_mount_equipment`).
- **Stats**: JSON en BD, validación de suma exacta vs `races.stat_points_total`.
- **Items**: Sin durabilidad, Quantity en todo el inventario.

## Comandos Ejecutados

(Se rellenará durante la ejecución)

## Actualización: Theming System

Hecho: sistema de theming dual implementado en landing-theme.css (claro "Crónica Antigua" + oscuro "Abismo").

Archivos:

public/css/landing-theme.css (actualizado con variables CSS duales)

Motivo: dualidad marcada entre fantasía inmersiva (claro) y grimdark funcional (oscuro), encaja con Warhammer/Juego de Tronos.

Pruebas: variables aplicadas, hover y transiciones OK en ambos modos.
