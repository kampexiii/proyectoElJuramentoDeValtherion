# 2026-01-30

Objetivo:
- Equipamiento del personaje (equipar/desequipar) + montura e inventario base.

Archivos tocados:
- app/Http/Controllers/CharacterController.php
- app/Http/Controllers/CharacterEquipmentController.php
- app/Models/Character.php
- app/Models/CharacterEquipment.php
- app/Models/CharacterItem.php
- app/Models/Item.php
- app/Models/Mount.php
- database/migrations/2026_01_23_091210_create_items_table.php
- database/migrations/2026_01_23_091212_create_equipment_slots_table.php
- database/migrations/2026_01_23_091213_create_character_items_table.php
- database/migrations/2026_01_29_220010_create_mounts_table.php
- database/migrations/2026_01_29_220011_add_mount_id_to_characters_table.php
- database/seeders/DatabaseSeeder.php
- database/seeders/MountSeeder.php
- public/assets/sprites/razas/.gitkeep
- resources/views/game/character/create.blade.php
- resources/views/game/character/edit.blade.php
- resources/views/game/inventario.blade.php
- resources/views/game/tienda.blade.php
- routes/web.php

Comandos ejecutados:
- git status --porcelain
- git branch --show-current
- git log --oneline -5
- php artisan route:list (falló: php no disponible)
- rg -n "items|equipment|inventory|mount" database/migrations

Verificación:
- Pendiente: Verificado con tinker y comprobando en BD (SQLite/DBeaver) el equipamiento e inventario (php no disponible en el entorno).

No se tocó .env ni database.sqlite.

---

Ajustes extra del viernes:
- Editar personaje sin cambios de nombre/raza/stats; stats mostradas con barras y cálculo de equipo.
- Equipar solo desde inventario y bloqueo si supera máximos.
- Migraciones de items/equipment/inventario con guardas si la tabla ya existe.

---

Tienda (diagnóstico sin tocar BD) + Ajustes mobile compactos:
- Tienda: filtros tolerantes a tipos/slots en español (arma/armadura/casco/anillo/colgante/montura) para mostrar items ya existentes.
- Ajustes: UI más compacta en mobile para que no se tape con la navbar inferior.

Archivos tocados:
- app/Services/WeeklyShopService.php
- resources/views/game/ajustes.blade.php
- resources/css/game/components/ajustes.css

Comandos ejecutados:
- git status --porcelain
- git branch --show-current
- git log --oneline -3
- php artisan --version (falló: php no disponible)
- php artisan route:list (falló: php no disponible)
- php artisan tinker --execute=... (falló: php no disponible)
- npm run build (OK)
- php artisan serve (falló: php no disponible)

Verificación:
- Pendiente en entorno local con php: comprobar conteo de items y vista de tienda.
- Ajustes: pendiente verificar en navegador móvil (sin solape con navbar).

No se tocó .env ni database.sqlite.

---

Tienda (seeder fallando por rarities) + corrección:
- El seeder de items fallaba por FK a tabla `rarities` inexistente.
- Se añadió migración mínima `rarities` y el seeder ahora rellena `rarity_id` si existe.
- Ajustes: compactación adicional en mobile.

Archivos tocados:
- database/migrations/2026_01_29_233000_create_rarities_table.php
- database/seeders/ShopItemsSeeder.php
- resources/css/game/components/ajustes.css

Comandos ejecutados:
- git status --porcelain
- git branch --show-current
- git log --oneline -3
- php artisan --version (falló: php no disponible)
- php artisan route:list (falló: php no disponible)

Verificación:
- Pendiente ejecutar migrate y repetir el seeder en entorno con php.

No se tocó .env ni database.sqlite.

---

Tienda (mobile en cuadrícula) + Ajustes más compactos:
- Tienda: en móvil, los objetos del mismo tipo se muestran en una sola fila con 3 cajas pequeñas y legibles.
- Ajustes: reducción adicional de gaps, padding y tipografías en desktop y mobile sin cortar contenido.

Archivos tocados:
- resources/css/game/components/tienda.css
- resources/css/game/components/ajustes.css

Comandos ejecutados:
- git status --porcelain

Verificación:
- Pendiente validar en móvil real que no hay cortes y se lee correctamente.

No se tocó .env ni database.sqlite.

---

HP en personajes + subida puntos de raza:
- Migración add_hp_to_characters_table.php para hp_max y hp_current.
- Modelo Character actualizado con fillable hp_max y hp_current.
- Inicialización en creación: hp_max = race.base_hp, hp_current = hp_max.
- RaceSeeder actualizado: freemium stat_points_total 32, premium 42, admin 52; min_role 'user' para freemium.
- Modelo Race ya existía.

Archivos tocados:
- app/Models/Character.php
- app/Http/Controllers/CharacterController.php
- database/seeders/RaceSeeder.php

Comandos ejecutados:
- php artisan test || true
- php artisan route:list
- php artisan optimize:clear

Verificación:
- Tests pasan salvo errores de BD previos (índice duplicado).
- Rutas OK.
- Caché limpiado.

No se tocó .env ni database.sqlite.
